import Link from 'next/link';
import Image from 'next/image';

import { useState, useEffect, useRef } from 'react';

import { motion } from 'framer-motion';
import styles from './PlaceCardItem.module.scss';

const PlaceCardItem = ({ card_data }) => {
	const [width, setWidth] = useState(0);
	const carousel = useRef();

	useEffect(() => {
		setWidth(carousel.current.scrollWidth - carousel.current.offsetWidth);
	}, []);

	const desktop_review_stars = (stars) => {
		const updatedStars = Math.floor(stars);
		let review_array = [];
		for (let i = 0; i < 5; i++) {
			if (i < updatedStars) {
				review_array.push(
					<svg
						key={i}
						width='14'
						height='14'
						viewBox='0 0 14 14'
						fill='none'
						xmlns='http://www.w3.org/2000/svg'
					>
						<path
							d='M13.9631 5.36985C13.871 5.08637 13.6195 4.88567 13.3232 4.85886L9.28184 4.49195L7.68466 0.752632C7.56674 0.477908 7.29842 0.300598 6.99977 0.300598C6.70112 0.300598 6.4327 0.477908 6.31553 0.752632L4.71835 4.49195L0.67632 4.85886C0.38002 4.8862 0.129115 5.0869 0.0364013 5.36985C-0.0557786 5.65333 0.0293516 5.96427 0.253446 6.1608L3.30841 8.83957L2.40766 12.8068C2.34175 13.0985 2.45498 13.4002 2.69701 13.5751C2.82711 13.6697 2.97996 13.7169 3.13335 13.7169C3.26515 13.7169 3.39707 13.6818 3.51488 13.6114L6.99977 11.5276L10.484 13.6114C10.7396 13.7641 11.061 13.7501 11.3025 13.5751C11.5446 13.4002 11.6578 13.0985 11.5919 12.8068L10.6911 8.83957L13.7461 6.1608C13.9701 5.96427 14.0553 5.65397 13.9631 5.36985V5.36985Z'
							fill='#FBA919'
						/>
					</svg>
				);
			} else {
				review_array.push(
					<svg
						key={i}
						width='14'
						height='14'
						viewBox='0 0 14 14'
						fill='none'
						xmlns='http://www.w3.org/2000/svg'
					>
						<path
							d='M13.9631 5.36985C13.871 5.08637 13.6195 4.88567 13.3232 4.85886L9.28184 4.49195L7.68466 0.752632C7.56674 0.477908 7.29842 0.300598 6.99977 0.300598C6.70112 0.300598 6.4327 0.477908 6.31553 0.752632L4.71835 4.49195L0.67632 4.85886C0.38002 4.8862 0.129115 5.0869 0.0364013 5.36985C-0.0557786 5.65333 0.0293516 5.96427 0.253446 6.1608L3.30841 8.83957L2.40766 12.8068C2.34175 13.0985 2.45498 13.4002 2.69701 13.5751C2.82711 13.6697 2.97996 13.7169 3.13335 13.7169C3.26515 13.7169 3.39707 13.6818 3.51488 13.6114L6.99977 11.5276L10.484 13.6114C10.7396 13.7641 11.061 13.7501 11.3025 13.5751C11.5446 13.4002 11.6578 13.0985 11.5919 12.8068L10.6911 8.83957L13.7461 6.1608C13.9701 5.96427 14.0553 5.65397 13.9631 5.36985Z'
							fill='#DDDDDD'
						/>
					</svg>
				);
			}
		}
		return review_array;
	};

	return (
		<div className={styles.PlaceCardItem}>
			<button className={styles.PlaceCardItem__SaveBtn_Absolute}>
				{card_data.isSaved ? (
					<>
						<svg
							width='17'
							height='16'
							viewBox='0 0 17 16'
							fill='none'
							xmlns='http://www.w3.org/2000/svg'
						>
							<path
								d='M15.0966 2.60611L15.0965 2.60609C14.5258 2.04881 13.6928 1.71423 12.4653 1.71423C12.1905 1.71423 11.8971 1.76163 11.5814 1.8668L15.0966 2.60611ZM15.0966 2.60611C15.6629 3.15912 16 3.96338 16 5.15388C16 6.18285 15.47 7.36422 14.127 8.70913L8.50034 14.1282L2.85732 8.68397L2.82365 8.65149L2.7871 8.6223C2.78718 8.62236 2.78605 8.62146 2.78361 8.6194L2.77338 8.61052C2.7644 8.60259 2.75246 8.59171 2.73729 8.57737C2.70676 8.54852 2.66776 8.51001 2.6194 8.46033C2.54522 8.3838 2.39581 8.2103 2.15651 7.91115L2.15647 7.91111C1.94294 7.6442 1.7537 7.3725 1.58805 7.09639L1.58803 7.09637C1.44507 6.8581 1.30387 6.54632 1.17238 6.14889L1.17234 6.14879C1.05343 5.78948 1 5.45913 1 5.1539C1 3.96335 1.33703 3.15911 1.9034 2.60612L1.90343 2.60609M15.0966 2.60611L1.90343 2.60609M10.6768 2.30371L10.6762 2.30412C10.3444 2.52217 10.0688 2.72073 9.84521 2.8994C9.62104 3.07885 9.40829 3.26925 9.20705 3.47046L8.50015 4.17725L7.7931 3.47061C7.59154 3.26917 7.37874 3.0787 7.15457 2.89928L10.6768 2.30371ZM10.6768 2.30371C10.953 2.12188 11.2538 1.97603 11.5813 1.86683L10.6768 2.30371ZM6.3235 2.30393L6.32337 2.30384C6.04682 2.1219 5.74612 1.97614 5.41854 1.86686L6.3235 2.30393ZM6.3235 2.30393C6.65557 2.52233 6.9311 2.72064 7.1542 2.89898L6.3235 2.30393ZM1.90343 2.60609C2.47407 2.04888 3.30716 1.71423 4.53454 1.71423C4.80917 1.71423 5.1025 1.76162 5.41822 1.86675L1.90343 2.60609Z'
								fill='#FA4B4B'
								stroke='#FA4B4B'
								strokeWidth='1'
							/>
						</svg>
						<p>Saved</p>
					</>
				) : (
					<>
						<svg
							width='17'
							height='16'
							viewBox='0 0 17 16'
							fill='none'
							xmlns='http://www.w3.org/2000/svg'
						>
							<path
								d='M15.0966 2.60611L15.0965 2.60609C14.5258 2.04881 13.6928 1.71423 12.4653 1.71423C12.1905 1.71423 11.8971 1.76163 11.5814 1.8668L15.0966 2.60611ZM15.0966 2.60611C15.6629 3.15912 16 3.96338 16 5.15388C16 6.18285 15.47 7.36422 14.127 8.70913L8.50034 14.1282L2.85732 8.68397L2.82365 8.65149L2.7871 8.6223C2.78718 8.62236 2.78605 8.62146 2.78361 8.6194L2.77338 8.61052C2.7644 8.60259 2.75246 8.59171 2.73729 8.57737C2.70676 8.54852 2.66776 8.51001 2.6194 8.46033C2.54522 8.3838 2.39581 8.2103 2.15651 7.91115L2.15647 7.91111C1.94294 7.6442 1.7537 7.3725 1.58805 7.09639L1.58803 7.09637C1.44507 6.8581 1.30387 6.54632 1.17238 6.14889L1.17234 6.14879C1.05343 5.78948 1 5.45913 1 5.1539C1 3.96335 1.33703 3.15911 1.9034 2.60612L1.90343 2.60609M15.0966 2.60611L1.90343 2.60609M10.6768 2.30371L10.6762 2.30412C10.3444 2.52217 10.0688 2.72073 9.84521 2.8994C9.62104 3.07885 9.40829 3.26925 9.20705 3.47046L8.50015 4.17725L7.7931 3.47061C7.59154 3.26917 7.37874 3.0787 7.15457 2.89928L10.6768 2.30371ZM10.6768 2.30371C10.953 2.12188 11.2538 1.97603 11.5813 1.86683L10.6768 2.30371ZM6.3235 2.30393L6.32337 2.30384C6.04682 2.1219 5.74612 1.97614 5.41854 1.86686L6.3235 2.30393ZM6.3235 2.30393C6.65557 2.52233 6.9311 2.72064 7.1542 2.89898L6.3235 2.30393ZM1.90343 2.60609C2.47407 2.04888 3.30716 1.71423 4.53454 1.71423C4.80917 1.71423 5.1025 1.76162 5.41822 1.86675L1.90343 2.60609Z'
								fill='white'
								stroke='#333333'
								strokeWidth='1'
							/>
						</svg>
						<p>Save</p>
					</>
				)}
			</button>
			<motion.div
				className={styles.PlaceCardItem__ImageCarousel}
				ref={carousel}
			>
				<motion.div
					className={styles.PlaceCardItem__ImageInnerCarousel}
					drag='x'
					dragConstraints={{ right: 0, left: -width }}
				>
					{card_data.imagesURL.map((imageURL, index) => (
						<motion.div
							key={index}
							className={styles.PlaceCardItem__ImageContainer}
						>
							<Image
								src={imageURL}
								alt={card_data.fullName}
								width={400}
								height={238}
								priority='high'
								layout='responsive'
							/>
						</motion.div>
					))}
				</motion.div>
			</motion.div>
			<div className={styles.PlaceCardItem__Info}>
				<div className={styles.PlaceCardItem__Mobile_Review_SaveBtn_Container}>
					<span className={styles.PlaceCardItem__Mobile_Review_Container}>
						<svg
							width='11'
							height='11'
							viewBox='0 0 11 11'
							fill='none'
							xmlns='http://www.w3.org/2000/svg'
						>
							<path
								d='M10.971 4.21919C10.8986 3.99645 10.701 3.83876 10.4682 3.81769L7.29282 3.52941L6.0379 0.591376C5.94524 0.375521 5.73442 0.236206 5.49977 0.236206C5.26512 0.236206 5.05421 0.375521 4.96215 0.591376L3.70722 3.52941L0.531342 3.81769C0.298535 3.83918 0.101395 3.99687 0.0285487 4.21919C-0.0438784 4.44193 0.0230097 4.68623 0.199084 4.84065L2.59942 6.9454L1.89168 10.0625C1.8399 10.2917 1.92886 10.5287 2.11903 10.6662C2.22125 10.7405 2.34135 10.7776 2.46186 10.7776C2.56543 10.7776 2.66907 10.75 2.76164 10.6947L5.49977 9.05745L8.2374 10.6947C8.43823 10.8147 8.69076 10.8037 8.88051 10.6662C9.07068 10.5287 9.15965 10.2917 9.10786 10.0625L8.40013 6.9454L10.8005 4.84065C10.9764 4.68623 11.0434 4.44243 10.971 4.21919Z'
								fill='#FCB61E'
							/>
						</svg>
						<p className={styles.PlaceCardItem__Mobile_Review_Stars}>
							{card_data.stars}
						</p>
						<p className={styles.PlaceCardItem__Mobile_Review_Para}>
							({card_data.noOfReviews} Reviews)
						</p>
					</span>
					<button className={styles.PlaceCardItem__Mobile_SaveBtn}>
						{card_data.isSaved ? (
							<svg
								width='17'
								height='16'
								viewBox='0 0 17 16'
								fill='none'
								xmlns='http://www.w3.org/2000/svg'
							>
								<path
									d='M15.0966 2.60611L15.0965 2.60609C14.5258 2.04881 13.6928 1.71423 12.4653 1.71423C12.1905 1.71423 11.8971 1.76163 11.5814 1.8668L15.0966 2.60611ZM15.0966 2.60611C15.6629 3.15912 16 3.96338 16 5.15388C16 6.18285 15.47 7.36422 14.127 8.70913L8.50034 14.1282L2.85732 8.68397L2.82365 8.65149L2.7871 8.6223C2.78718 8.62236 2.78605 8.62146 2.78361 8.6194L2.77338 8.61052C2.7644 8.60259 2.75246 8.59171 2.73729 8.57737C2.70676 8.54852 2.66776 8.51001 2.6194 8.46033C2.54522 8.3838 2.39581 8.2103 2.15651 7.91115L2.15647 7.91111C1.94294 7.6442 1.7537 7.3725 1.58805 7.09639L1.58803 7.09637C1.44507 6.8581 1.30387 6.54632 1.17238 6.14889L1.17234 6.14879C1.05343 5.78948 1 5.45913 1 5.1539C1 3.96335 1.33703 3.15911 1.9034 2.60612L1.90343 2.60609M15.0966 2.60611L1.90343 2.60609M10.6768 2.30371L10.6762 2.30412C10.3444 2.52217 10.0688 2.72073 9.84521 2.8994C9.62104 3.07885 9.40829 3.26925 9.20705 3.47046L8.50015 4.17725L7.7931 3.47061C7.59154 3.26917 7.37874 3.0787 7.15457 2.89928L10.6768 2.30371ZM10.6768 2.30371C10.953 2.12188 11.2538 1.97603 11.5813 1.86683L10.6768 2.30371ZM6.3235 2.30393L6.32337 2.30384C6.04682 2.1219 5.74612 1.97614 5.41854 1.86686L6.3235 2.30393ZM6.3235 2.30393C6.65557 2.52233 6.9311 2.72064 7.1542 2.89898L6.3235 2.30393ZM1.90343 2.60609C2.47407 2.04888 3.30716 1.71423 4.53454 1.71423C4.80917 1.71423 5.1025 1.76162 5.41822 1.86675L1.90343 2.60609Z'
									fill='#FA4B4B'
									stroke='#FA4B4B'
									strokeWidth='1'
								/>
							</svg>
						) : (
							<svg
								width='17'
								height='16'
								viewBox='0 0 17 16'
								fill='none'
								xmlns='http://www.w3.org/2000/svg'
							>
								<path
									d='M15.0966 2.60611L15.0965 2.60609C14.5258 2.04881 13.6928 1.71423 12.4653 1.71423C12.1905 1.71423 11.8971 1.76163 11.5814 1.8668L15.0966 2.60611ZM15.0966 2.60611C15.6629 3.15912 16 3.96338 16 5.15388C16 6.18285 15.47 7.36422 14.127 8.70913L8.50034 14.1282L2.85732 8.68397L2.82365 8.65149L2.7871 8.6223C2.78718 8.62236 2.78605 8.62146 2.78361 8.6194L2.77338 8.61052C2.7644 8.60259 2.75246 8.59171 2.73729 8.57737C2.70676 8.54852 2.66776 8.51001 2.6194 8.46033C2.54522 8.3838 2.39581 8.2103 2.15651 7.91115L2.15647 7.91111C1.94294 7.6442 1.7537 7.3725 1.58805 7.09639L1.58803 7.09637C1.44507 6.8581 1.30387 6.54632 1.17238 6.14889L1.17234 6.14879C1.05343 5.78948 1 5.45913 1 5.1539C1 3.96335 1.33703 3.15911 1.9034 2.60612L1.90343 2.60609M15.0966 2.60611L1.90343 2.60609M10.6768 2.30371L10.6762 2.30412C10.3444 2.52217 10.0688 2.72073 9.84521 2.8994C9.62104 3.07885 9.40829 3.26925 9.20705 3.47046L8.50015 4.17725L7.7931 3.47061C7.59154 3.26917 7.37874 3.0787 7.15457 2.89928L10.6768 2.30371ZM10.6768 2.30371C10.953 2.12188 11.2538 1.97603 11.5813 1.86683L10.6768 2.30371ZM6.3235 2.30393L6.32337 2.30384C6.04682 2.1219 5.74612 1.97614 5.41854 1.86686L6.3235 2.30393ZM6.3235 2.30393C6.65557 2.52233 6.9311 2.72064 7.1542 2.89898L6.3235 2.30393ZM1.90343 2.60609C2.47407 2.04888 3.30716 1.71423 4.53454 1.71423C4.80917 1.71423 5.1025 1.76162 5.41822 1.86675L1.90343 2.60609Z'
									fill='white'
									stroke='#333333'
									strokeWidth='1'
								/>
							</svg>
						)}
					</button>
				</div>
				<h3 className={styles.PlaceCardItem__FullName}>{card_data.fullName}</h3>
				<span className={styles.PlaceCardItem__Destination_Container}>
					<p className={styles.PlaceCardItem__Destination_Para}>
						<svg
							width='8'
							height='10'
							viewBox='0 0 8 10'
							fill='none'
							xmlns='http://www.w3.org/2000/svg'
						>
							<path
								d='M6.96 1.71245C6.35311 0.665108 5.27514 0.0252441 4.07641 0.000791016C4.02524 -0.000263672 3.97373 -0.000263672 3.92254 0.000791016C2.72383 0.0252441 1.64586 0.665108 1.03895 1.71245C0.418594 2.783 0.401622 4.06894 0.993536 5.15235L3.47328 9.69116C3.4744 9.69317 3.47551 9.69519 3.47666 9.69718C3.58576 9.88681 3.78121 10 3.99951 10C4.2178 10 4.41324 9.88679 4.52233 9.69718C4.52348 9.69519 4.52459 9.69317 4.52571 9.69116L7.00545 5.15235C7.59733 4.06894 7.58036 2.783 6.96 1.71245V1.71245ZM3.99947 4.53126C3.22406 4.53126 2.59322 3.90042 2.59322 3.12501C2.59322 2.3496 3.22406 1.71876 3.99947 1.71876C4.77489 1.71876 5.40573 2.3496 5.40573 3.12501C5.40573 3.90042 4.7749 4.53126 3.99947 4.53126Z'
								fill='#3564E2'
							/>
						</svg>
						{card_data.destination}
					</p>
					{card_data.otherDetailRegardingDestination ? (
						<>
							<p className={styles.PlaceCardItem__Seperation_Line}>|</p>
							<p
								className={styles.PlaceCardItem__Destination_OtherDetails_Para}
							>
								{card_data.otherDetailRegardingDestination}
							</p>
						</>
					) : null}
				</span>
				<span className={styles.PlaceCardItem__Tags_Container}>
					{card_data.description.map((tag, index) => (
						<p key={index} className={styles.PlaceCardItem__Tags}>
							{tag}
						</p>
					))}
				</span>
				<div className={styles.PlaceCardItem__Desktop_Review_Container}>
					<p className={styles.PlaceCardItem__Desktop_Review_Stars_Para}>
						{card_data.stars}
					</p>
					<span
						className={styles.PlaceCardItem__Desktop_Review_Stars_SVG_Container}
					>
						{desktop_review_stars(card_data.stars).map((starSVG) => {
							return starSVG;
						})}
					</span>
					<p className={styles.PlaceCardItem__Seperation_Line}>|</p>
					<p className={styles.PlaceCardItem__Desktop_Review_Para}>
						{card_data.noOfReviews} Reviews
					</p>
				</div>
				<div className={styles.PlaceCardItem__Price_ViewDetails_Container}>
					<div className={styles.PlaceCardItem__Price_Container}>
						<p className={styles.PlaceCardItem__OldPrice_Para}>
							{card_data.currencySymbol} {card_data.originalPrice}
						</p>
						<span
							className={styles.PlaceCardItem__DiscountedPrice_Para_Container}
						>
							<p className={styles.PlaceCardItem__DiscountedPrice_Para_Price}>
								{card_data.currencySymbol} {card_data.discountedPrice}
							</p>
							<p className={styles.PlaceCardItem__DiscountedPrice_Para_Unit}>
								per night
							</p>
						</span>
					</div>
					<Link href='/' passHref>
						<a
							className={styles.PlaceCardItem__ViewDetails_Link}
							title='View Details'
							aria-label='View Details'
						>
							View Details
							<svg
								width='10'
								height='6'
								viewBox='0 0 10 6'
								fill='none'
								xmlns='http://www.w3.org/2000/svg'
							>
								<path
									d='M5.00071 5.85018C4.82149 5.85018 4.64229 5.78175 4.50565 5.64518L0.205874 1.34536C-0.067648 1.07184 -0.067648 0.628372 0.205874 0.354961C0.479285 0.0815496 0.922665 0.0815496 1.19621 0.354961L5.00071 4.15968L8.80522 0.355094C9.07874 0.0816825 9.52208 0.0816825 9.79547 0.355094C10.0691 0.628505 10.0691 1.07197 9.79547 1.34549L5.49576 5.64531C5.35906 5.78191 5.17986 5.85018 5.00071 5.85018Z'
									fill='#3564E2'
								/>
							</svg>
						</a>
					</Link>
				</div>
			</div>
		</div>
	);
};

export default PlaceCardItem;
